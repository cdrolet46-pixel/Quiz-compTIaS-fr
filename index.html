<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CompTIA Security+ SY0-701 - Entra√Ænement Certifi√© 2026</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .start-screen {
            text-align: center;
        }

        .quiz-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .quiz-option {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            padding: 30px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            border: none;
            font-size: 1.1em;
        }

        .quiz-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
        }

        .quiz-option h3 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .quiz-screen {
            display: none;
        }

        .progress-bar {
            background: #e5e7eb;
            height: 10px;
            border-radius: 5px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #10b981 0%, #059669 100%);
            height: 100%;
            transition: width 0.3s;
        }

        .question-card {
            background: #f9fafb;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 4px solid #3b82f6;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .question-number {
            background: #3b82f6;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .domain-tag {
            background: #8b5cf6;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
        }

        .question-text {
            font-size: 1.2em;
            margin: 20px 0;
            line-height: 1.6;
            color: #1f2937;
        }

        .hint-box {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 12px 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-size: 0.95em;
        }

        .hint-toggle {
            background: none;
            border: none;
            color: #f59e0b;
            cursor: pointer;
            font-weight: bold;
            text-decoration: underline;
            padding: 0;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .hint-toggle:hover {
            color: #d97706;
        }

        .hint-content {
            display: none;
            color: #92400e;
            margin-top: 10px;
        }

        .options {
            margin: 20px 0;
        }

        .option {
            background: white;
            border: 2px solid #e5e7eb;
            padding: 15px 20px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: #3b82f6;
            background: #eff6ff;
        }

        .option.selected {
            border-color: #3b82f6;
            background: #dbeafe;
        }

        .option.correct {
            border-color: #10b981;
            background: #d1fae5;
        }

        .option.incorrect {
            border-color: #ef4444;
            background: #fee2e2;
        }

        .option-letter {
            background: #3b82f6;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .option.correct .option-letter {
            background: #10b981;
        }

        .option.incorrect .option-letter {
            background: #ef4444;
        }

        .explanation {
            display: none;
            background: #ecfdf5;
            border-left: 4px solid #10b981;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .explanation h4 {
            color: #065f46;
            margin-bottom: 10px;
        }

        .explanation p {
            color: #047857;
            line-height: 1.6;
        }

        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: space-between;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .results-screen {
            display: none;
            text-align: center;
        }

        .score-display {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 50px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .score-display h2 {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .score-display p {
            font-size: 1.3em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: #f9fafb;
            padding: 20px;
            border-radius: 10px;
            border-top: 4px solid #3b82f6;
        }

        .stat-card h3 {
            color: #6b7280;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .stat-card p {
            font-size: 2em;
            color: #1f2937;
            font-weight: bold;
        }

        .domain-results {
            text-align: left;
            margin: 30px 0;
        }

        .domain-result {
            background: #f9fafb;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
        }

        .domain-result-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .domain-bar {
            background: #e5e7eb;
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
        }

        .domain-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6 0%, #2563eb 100%);
            transition: width 0.5s;
        }

        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }

            .header h1 {
                font-size: 1.5em;
            }

            .quiz-option h3 {
                font-size: 2em;
            }

            .button-group {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è CompTIA Security+ SY0-701</h1>
            <p>Entra√Ænement Certifi√© - Mise √† jour F√©vrier 2026</p>
        </div>

        <div class="content">
            <!-- √âcran de d√©marrage -->
            <div class="start-screen" id="startScreen">
                <h2 style="margin-bottom: 20px;">Choisissez votre mode d'entra√Ænement</h2>
                <div class="info-box">
                    <strong>üìö Banque de questions compl√®te</strong><br>
                    Plus de 250 questions r√©elles couvrant les 5 domaines de l'examen SY0-701
                </div>
                <div class="quiz-selector">
                    <button class="quiz-option" onclick="startQuiz(20)">
                        <h3>20</h3>
                        <p>Questions</p>
                        <small>Entra√Ænement rapide</small>
                    </button>
                    <button class="quiz-option" onclick="startQuiz(50)">
                        <h3>50</h3>
                        <p>Questions</p>
                        <small>Session moyenne</small>
                    </button>
                    <button class="quiz-option" onclick="startQuiz(90)">
                        <h3>90</h3>
                        <p>Questions</p>
                        <small>Simulation compl√®te</small>
                    </button>
                </div>
                <div class="info-box">
                    <strong>üìñ Domaines couverts :</strong><br>
                    1Ô∏è‚É£ Menaces, Attaques et Vuln√©rabilit√©s (24%)<br>
                    2Ô∏è‚É£ Architecture et Conception (21%)<br>
                    3Ô∏è‚É£ Mise en ≈ìuvre (25%)<br>
                    4Ô∏è‚É£ Op√©rations et R√©ponse aux incidents (16%)<br>
                    5Ô∏è‚É£ Gouvernance, Risque et Conformit√© (14%)
                </div>
            </div>

            <!-- √âcran de quiz -->
            <div class="quiz-screen" id="quizScreen">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div id="questionContainer"></div>
                <div class="button-group">
                    <button class="btn btn-secondary" onclick="previousQuestion()">‚Üê Pr√©c√©dent</button>
                    <button class="btn btn-primary" id="submitBtn" onclick="submitAnswer()">Valider la r√©ponse</button>
                    <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" style="display: none;">Suivant ‚Üí</button>
                </div>
            </div>

            <!-- √âcran de r√©sultats -->
            <div class="results-screen" id="resultsScreen">
                <h2>üéì R√©sultats de votre examen</h2>
                <div class="score-display" id="scoreDisplay"></div>
                <div class="stats-grid" id="statsGrid"></div>
                <div class="domain-results" id="domainResults"></div>
                <div class="button-group" style="justify-content: center;">
                    <button class="btn btn-primary" onclick="location.reload()">Recommencer un nouveau quiz</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // √âNORME BANQUE DE QUESTIONS - CompTIA Security+ SY0-701
        // Plus de 250 questions r√©elles et √† jour (F√©vrier 2026)
        const QUESTION_BANK = [
            // ============================================================
            // DOMAINE 1: MENACES, ATTAQUES ET VULN√âRABILIT√âS (24%)
            // 60 questions dans ce domaine
            // ============================================================
            
            // Phishing et Ing√©nierie sociale (10 questions)
            {
                id: 1,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un analyste de s√©curit√© d√©tecte qu'un attaquant a compromis plusieurs comptes utilisateurs en envoyant des e-mails frauduleux qui imitent parfaitement le portail de connexion de l'entreprise. Les e-mails sont personnalis√©s avec le nom de chaque employ√©. Quel type d'attaque est en cours ?",
                hint: "Cette attaque cible des individus sp√©cifiques avec des messages personnalis√©s, contrairement au phishing de masse.",
                options: [
                    "Whaling",
                    "Spear phishing",
                    "Vishing",
                    "Pharming"
                ],
                correct: 1,
                explanation: "Le **spear phishing** est une attaque cibl√©e par e-mail qui vise des individus ou organisations sp√©cifiques avec des messages hautement personnalis√©s. Le **whaling** cible sp√©cifiquement les cadres dirigeants (C-level). Le **vishing** utilise la voix/t√©l√©phone pour obtenir des informations. Le **pharming** redirige le trafic DNS vers des sites frauduleux sans n√©cessiter d'interaction par e-mail."
            },
            {
                id: 2,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant t√©l√©phone √† un employ√© en se faisant passer pour le support technique et demande le mot de passe de l'utilisateur pour 'r√©soudre un probl√®me urgent'. Quelle technique d'ing√©nierie sociale est utilis√©e ?",
                hint: "Le canal de communication utilis√© ici est vocal plut√¥t qu'√©lectronique.",
                options: [
                    "Pretexting",
                    "Vishing",
                    "Baiting",
                    "Tailgating"
                ],
                correct: 1,
                explanation: "Le **vishing** (voice phishing) utilise le t√©l√©phone pour tromper les victimes et obtenir des informations sensibles. Le **pretexting** cr√©e un sc√©nario fabriqu√© pour obtenir des informations. Le **baiting** utilise un app√¢t physique ou num√©rique. Le **tailgating** est l'acc√®s physique non autoris√© en suivant quelqu'un."
            },
            {
                id: 3,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "SC√âNARIO: Un employ√© trouve une cl√© USB dans le parking de l'entreprise avec l'√©tiquette 'Bonus 2026 - Confidentiel'. Il la branche sur son ordinateur par curiosit√©. Quelle attaque d'ing√©nierie sociale a r√©ussi ?",
                hint: "Cette technique utilise la curiosit√© humaine et un app√¢t physique.",
                options: [
                    "Baiting (App√¢t)",
                    "Pretexting",
                    "Shoulder surfing",
                    "Dumpster diving"
                ],
                correct: 0,
                explanation: "Le **Baiting** (app√¢t) utilise la curiosit√© humaine avec un objet attractif (cl√© USB, DVD) contenant un malware. L'attaquant compte sur la tentation pour que la victime l'utilise. Le **pretexting** cr√©e un faux sc√©nario. Le **shoulder surfing** observe par-dessus l'√©paule. Le **dumpster diving** fouille les poubelles."
            },
            {
                id: 4,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant suit discr√®tement un employ√© autoris√© pour entrer dans une zone s√©curis√©e sans badge d'acc√®s. Quelle technique physique d'ing√©nierie sociale est utilis√©e ?",
                hint: "Cette m√©thode exploite la politesse en 'suivant de pr√®s' quelqu'un qui ouvre une porte.",
                options: [
                    "Tailgating (Talonnage)",
                    "Piggybacking",
                    "Shoulder surfing",
                    "Impersonation"
                ],
                correct: 0,
                explanation: "Le **Tailgating** (talonnage) consiste √† suivre discr√®tement une personne autoris√©e dans une zone s√©curis√©e sans son consentement. Le **Piggybacking** est similaire mais avec le consentement (tenir la porte). Le **Shoulder surfing** observe l'√©cran ou le clavier. L'**Impersonation** usurpe une identit√©."
            },
            {
                id: 5,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "SC√âNARIO: Un attaquant envoie un e-mail au directeur financier pr√©tendant √™tre le PDG en d√©placement urgent √† l'√©tranger, demandant un virement imm√©diat de 50 000‚Ç¨ pour conclure une acquisition confidentielle. Quelle attaque sophistiqu√©e est en cours ?",
                hint: "Cette attaque cible sp√©cifiquement les cadres dirigeants avec des demandes financi√®res urgentes.",
                options: [
                    "Spear phishing standard",
                    "Whaling (CEO Fraud / BEC)",
                    "Pharming",
                    "Ransomware"
                ],
                correct: 1,
                explanation: "Le **Whaling** (ou CEO Fraud / BEC - Business Email Compromise) est une forme sophistiqu√©e de spear phishing ciblant sp√©cifiquement les cadres dirigeants ou employ√©s avec autorit√© financi√®re. L'attaquant usurpe l'identit√© d'un dirigeant pour demander des virements urgents. C'est une menace majeure causant des milliards de pertes annuellement."
            },
            {
                id: 6,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant cr√©e un site web malveillant avec l'URL 'g00gle.com' (avec des z√©ros au lieu de 'o') pour tromper les utilisateurs. Quelle technique est utilis√©e ?",
                hint: "Cette technique exploite les erreurs de frappe et les caract√®res visuellement similaires.",
                options: [
                    "Typosquatting (Cybersquatting)",
                    "Pharming",
                    "Clickjacking",
                    "Session hijacking"
                ],
                correct: 0,
                explanation: "Le **Typosquatting** (ou cybersquatting) enregistre des noms de domaine similaires √† des sites populaires avec des fautes de frappe ou des caract√®res similaires (0 au lieu de O, 1 au lieu de l, etc.) pour capturer le trafic d'utilisateurs inattentifs. Le **pharming** redirige via DNS. Le **clickjacking** cache des √©l√©ments cliquables. Le **session hijacking** vole des sessions."
            },
            {
                id: 7,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant envoie un SMS pr√©tendant provenir de la banque de la victime avec un lien urgent pour 'v√©rifier votre compte'. Quelle variante de phishing est utilis√©e ?",
                hint: "Cette attaque utilise les messages texte comme vecteur.",
                options: [
                    "Vishing",
                    "Smishing (SMS phishing)",
                    "Whaling",
                    "Spear phishing"
                ],
                correct: 1,
                explanation: "Le **Smishing** (SMS phishing) utilise les messages texte pour tromper les victimes et les diriger vers des sites malveillants ou leur faire r√©v√©ler des informations sensibles. Cette technique est en augmentation avec l'usage des smartphones. Le **vishing** utilise la voix. Le **whaling** cible les dirigeants. Le **spear phishing** utilise l'e-mail."
            },
            {
                id: 8,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle d√©fense est la PLUS efficace contre les attaques d'ing√©nierie sociale ?",
                hint: "La s√©curit√© technique ne suffit pas ; l'√©l√©ment humain doit √™tre renforc√©.",
                options: [
                    "Pare-feu de nouvelle g√©n√©ration",
                    "Formation et sensibilisation continue des utilisateurs",
                    "Antivirus √† jour",
                    "Chiffrement des donn√©es"
                ],
                correct: 1,
                explanation: "La **Formation et sensibilisation continue des utilisateurs** est la d√©fense la plus efficace contre l'ing√©nierie sociale car ces attaques exploitent la psychologie humaine plut√¥t que les failles techniques. Les utilisateurs inform√©s peuvent identifier et signaler les tentatives. Les solutions techniques (pare-feu, antivirus, chiffrement) sont des couches suppl√©mentaires mais ne prot√®gent pas contre la manipulation humaine."
            },
            {
                id: 9,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant observe discr√®tement un utilisateur taper son code PIN au guichet automatique. Quelle technique simple mais efficace est utilis√©e ?",
                hint: "Cette attaque n√©cessite simplement une observation visuelle directe.",
                options: [
                    "Shoulder surfing (Observation par-dessus l'√©paule)",
                    "Keylogging",
                    "Screen scraping",
                    "Sniffing"
                ],
                correct: 0,
                explanation: "Le **Shoulder surfing** consiste √† observer visuellement (directement ou avec une cam√©ra) ce qu'une personne tape sur un clavier, entre comme code PIN, ou consulte sur son √©cran. Protection: √™tre vigilant de son environnement, utiliser des filtres de confidentialit√© d'√©cran, cacher le clavier. Le **keylogging** enregistre via logiciel/mat√©riel. Le **screen scraping** capture l'√©cran. Le **sniffing** capture le trafic r√©seau."
            },
            {
                id: 10,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant fouille les poubelles d'une entreprise pour trouver des documents contenant des informations sensibles non d√©chiquet√©es. Quelle technique de collecte d'informations est utilis√©e ?",
                hint: "Cette technique low-tech mais efficace cible les d√©chets physiques.",
                options: [
                    "Social engineering",
                    "Dumpster diving (Fouille de poubelles)",
                    "Reconnaissance passive",
                    "OSINT (Open Source Intelligence)"
                ],
                correct: 1,
                explanation: "Le **Dumpster diving** (fouille de poubelles) consiste √† r√©cup√©rer des informations sensibles dans les d√©chets: documents, disques durs, notes post-it avec mots de passe, organigrammes. Protection: d√©chiquetage crois√© (cross-cut shredding), destruction s√©curis√©e des supports, politique de bureau propre (clean desk). Le **social engineering** est plus large. La **reconnaissance passive** utilise des sources publiques. L'**OSINT** collecte des renseignements open source."
            },

            // Injection et exploitation web (15 questions)
            {
                id: 11,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un administrateur syst√®me remarque dans les logs du serveur web des requ√™tes HTTP contenant des caract√®res comme ' OR '1'='1' -- et des tentatives d'affichage de tables syst√®me. Quelle attaque est en cours ?",
                hint: "Cette technique exploite les failles dans les requ√™tes de base de donn√©es pour manipuler ou extraire des donn√©es.",
                options: [
                    "Cross-Site Scripting (XSS)",
                    "Injection SQL",
                    "Cross-Site Request Forgery (CSRF)",
                    "Directory Traversal"
                ],
                correct: 1,
                explanation: "L'**injection SQL** ins√®re du code SQL malveillant dans les requ√™tes pour manipuler la base de donn√©es. La syntaxe ' OR '1'='1 est une signature classique qui rend toujours vraie une condition, permettant de contourner l'authentification ou extraire toutes les donn√©es. Protection: requ√™tes param√©tr√©es (prepared statements), validation des entr√©es, principe du moindre privil√®ge pour les comptes DB."
            },
            {
                id: 12,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle vuln√©rabilit√© permet √† un attaquant d'ex√©cuter du code JavaScript malveillant dans le navigateur d'une victime en exploitant un champ de formulaire mal s√©curis√© sur un site web ?",
                hint: "Cette faille affecte les applications web qui n'assainissent pas correctement les entr√©es utilisateur c√¥t√© client.",
                options: [
                    "Injection SQL",
                    "Cross-Site Scripting (XSS)",
                    "Buffer Overflow",
                    "Remote Code Execution (RCE)"
                ],
                correct: 1,
                explanation: "Le **Cross-Site Scripting (XSS)** injecte des scripts malveillants (g√©n√©ralement JavaScript) dans des pages web consult√©es par d'autres utilisateurs. Trois types: **Reflected XSS** (imm√©diat), **Stored XSS** (persistant), **DOM-based XSS** (c√¥t√© client). Protection: encodage des sorties, Content Security Policy (CSP), validation des entr√©es, frameworks s√©curis√©s."
            },
            {
                id: 13,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "SC√âNARIO: Un site web bancaire ne valide pas qu'une requ√™te de virement provient r√©ellement de l'utilisateur. Un attaquant cr√©e une page web malveillante qui, lorsque visit√©e par une victime connect√©e √† sa banque, d√©clenche automatiquement un virement vers le compte de l'attaquant. Quelle attaque est utilis√©e ?",
                hint: "Cette attaque exploite la confiance qu'un site web a envers le navigateur de l'utilisateur authentifi√©.",
                options: [
                    "Cross-Site Scripting (XSS)",
                    "Session Hijacking",
                    "Cross-Site Request Forgery (CSRF)",
                    "Clickjacking"
                ],
                correct: 2,
                explanation: "Le **Cross-Site Request Forgery (CSRF)** force un utilisateur authentifi√© √† ex√©cuter des actions non voulues en exploitant sa session active. L'attaquant ne voit pas la r√©ponse mais d√©clenche l'action. Protection: tokens CSRF (anti-CSRF tokens) uniques par session/requ√™te, validation du referer, double submit cookies, SameSite cookie attribute."
            },
            {
                id: 14,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un site web permet aux utilisateurs de t√©l√©charger des images de profil. Un attaquant t√©l√©charge un fichier nomm√© 'image.php.jpg' qui contient du code PHP malveillant et parvient √† l'ex√©cuter sur le serveur. Quelle vuln√©rabilit√© a √©t√© exploit√©e ?",
                hint: "Le probl√®me r√©side dans l'absence de validation appropri√©e du type de fichier t√©l√©charg√©.",
                options: [
                    "Directory Traversal",
                    "Remote File Inclusion (RFI)",
                    "Unrestricted File Upload",
                    "Server-Side Request Forgery (SSRF)"
                ],
                correct: 2,
                explanation: "L'**Unrestricted File Upload** permet le t√©l√©chargement de fichiers dangereux sans validation appropri√©e du type MIME, de l'extension et du contenu. L'attaquant peut uploader des webshells, scripts ex√©cutables. Protection: validation du type de fichier (magic bytes), liste blanche d'extensions, renommage des fichiers, stockage hors du webroot, scan antivirus, restrictions d'ex√©cution."
            },
            {
                id: 15,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant manipule l'URL pour acc√©der √† des fichiers syst√®me en utilisant des s√©quences comme '../../../etc/passwd'. Quelle vuln√©rabilit√© web est exploit√©e ?",
                hint: "Cette attaque navigue dans l'arborescence des fichiers en remontant les r√©pertoires.",
                options: [
                    "Directory Traversal (Path Traversal)",
                    "Local File Inclusion (LFI)",
                    "Remote File Inclusion (RFI)",
                    "Command Injection"
                ],
                correct: 0,
                explanation: "Le **Directory Traversal** (ou Path Traversal) utilise des s√©quences comme ../ (dot-dot-slash) pour naviguer hors des r√©pertoires autoris√©s et acc√©der √† des fichiers syst√®me sensibles. Protection: validation stricte des chemins, liste blanche de fichiers autoris√©s, chroot jails, restrictions de permissions. La **LFI** inclut des fichiers locaux. La **RFI** inclut des fichiers distants. La **Command Injection** ex√©cute des commandes syst√®me."
            },
            {
                id: 16,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Une application web PHP inclut dynamiquement des fichiers bas√©s sur un param√®tre GET non valid√©: include($_GET['page']). Un attaquant peut charger des fichiers malveillants distants. Quelle vuln√©rabilit√© est pr√©sente ?",
                hint: "Cette faille permet d'inclure et d'ex√©cuter du code depuis des serveurs externes.",
                options: [
                    "Local File Inclusion (LFI)",
                    "Remote File Inclusion (RFI)",
                    "Command Injection",
                    "XML External Entity (XXE)"
                ],
                correct: 1,
                explanation: "La **Remote File Inclusion (RFI)** permet d'inclure et d'ex√©cuter du code depuis des URLs distantes (ex: http://attacker.com/shell.txt). Plus dangereuse que LFI car l'attaquant contr√¥le totalement le code ex√©cut√©. Protection: d√©sactiver allow_url_fopen/allow_url_include en PHP, validation stricte des entr√©es, liste blanche de fichiers. La **LFI** inclut uniquement des fichiers locaux."
            },
            {
                id: 17,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant envoie une entr√©e sp√©cialement format√©e √† une application qui ex√©cute des commandes syst√®me, permettant l'ex√©cution de commandes arbitraires. Par exemple: 'fichier.txt; rm -rf /' Quelle vuln√©rabilit√© est exploit√©e ?",
                hint: "Cette faille permet d'ex√©cuter des commandes du syst√®me d'exploitation via l'application.",
                options: [
                    "SQL Injection",
                    "Command Injection (OS Command Injection)",
                    "Code Injection",
                    "LDAP Injection"
                ],
                correct: 1,
                explanation: "La **Command Injection** (OS Command Injection) permet d'ex√©cuter des commandes syst√®me arbitraires en exploitant des applications qui appellent des commandes shell sans validation. Utilise des s√©parateurs (; | & || &&). Protection: √©viter d'appeler des commandes shell, validation stricte, liste blanche de commandes, principe du moindre privil√®ge, utilisation d'APIs au lieu de shell."
            },
            {
                id: 18,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "SC√âNARIO: Une API REST accepte des donn√©es XML. Un attaquant envoie un payload XML contenant une r√©f√©rence √† un fichier local (/etc/passwd) qui est ensuite trait√© et renvoy√© dans la r√©ponse. Quelle attaque exploite le parser XML ?",
                hint: "Cette vuln√©rabilit√© abuse du traitement des entit√©s externes dans les documents XML.",
                options: [
                    "XML Injection",
                    "XXE (XML External Entity)",
                    "SOAP Injection",
                    "XPath Injection"
                ],
                correct: 1,
                explanation: "L'**XXE (XML External Entity)** exploite les parsers XML mal configur√©s qui traitent les entit√©s externes, permettant: lecture de fichiers locaux, SSRF, d√©ni de service, ex√©cution de code. Protection: d√©sactiver les entit√©s externes (libxml_disable_entity_loader en PHP), utiliser des parsers s√©curis√©s, valider le sch√©ma XML, utiliser JSON au lieu de XML si possible."
            },
            {
                id: 19,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant force une application serveur √† effectuer des requ√™tes HTTP vers des destinations internes (localhost, r√©seau interne) en manipulant un param√®tre URL. Quelle vuln√©rabilit√© permet cet abus ?",
                hint: "Cette attaque transforme le serveur en proxy pour scanner le r√©seau interne.",
                options: [
                    "Open Redirect",
                    "Server-Side Request Forgery (SSRF)",
                    "Cross-Site Request Forgery (CSRF)",
                    "HTTP Response Splitting"
                ],
                correct: 1,
                explanation: "Le **Server-Side Request Forgery (SSRF)** force le serveur √† faire des requ√™tes vers des destinations non pr√©vues: r√©seau interne (192.168.x.x), localhost (127.0.0.1), services cloud metadata (169.254.169.254). Permet: scan de ports internes, acc√®s √† services non expos√©s, lecture de m√©tadonn√©es cloud. Protection: validation stricte des URLs, liste blanche de destinations, segmentation r√©seau, d√©sactivation des redirections."
            },
            {
                id: 20,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Une page web affiche une iframe invisible qui charge le compte bancaire de la victime. Par-dessus, l'attaquant place un bouton 'T√©l√©charger film gratuit' qui d√©clenche en r√©alit√© un virement bancaire. Quelle technique d'exploitation UI est utilis√©e ?",
                hint: "Cette attaque cache visuellement l'action r√©elle derri√®re une action apparemment inoffensive.",
                options: [
                    "Cross-Site Scripting (XSS)",
                    "Clickjacking (UI Redressing)",
                    "Tabnabbing",
                    "Cross-Site Request Forgery (CSRF)"
                ],
                correct: 1,
                explanation: "Le **Clickjacking** (UI Redressing) utilise des iframes invisibles ou transparentes pour tromper l'utilisateur et le faire cliquer sur des √©l√©ments cach√©s. Variante: Likejacking (like Facebook). Protection: en-t√™te X-Frame-Options (DENY/SAMEORIGIN), Content Security Policy (frame-ancestors), JavaScript framebusting (moins fiable)."
            },
            {
                id: 21,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle header HTTP de s√©curit√© emp√™che un site web d'√™tre charg√© dans une iframe, prot√©geant ainsi contre le clickjacking ?",
                hint: "Cet en-t√™te de r√©ponse contr√¥le si et comment un site peut √™tre affich√© dans un frame.",
                options: [
                    "Content-Security-Policy",
                    "X-Frame-Options",
                    "Strict-Transport-Security",
                    "X-Content-Type-Options"
                ],
                correct: 1,
                explanation: "**X-Frame-Options** contr√¥le si un site peut √™tre charg√© dans un frame/iframe avec trois valeurs: DENY (jamais), SAMEORIGIN (m√™me origine uniquement), ALLOW-FROM (obsol√®te). Moderne alternative: Content-Security-Policy avec directive frame-ancestors. **CSP** est plus large. **HSTS** force HTTPS. **X-Content-Type-Options** emp√™che le MIME sniffing."
            },
            {
                id: 22,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Une application web ne valide pas la destination d'une redirection et permet √† un attaquant de rediriger les utilisateurs vers un site malveillant via un param√®tre: 'http://site.com/redirect?url=http://malicious.com'. Quelle vuln√©rabilit√© est pr√©sente ?",
                hint: "Cette faille abuse des m√©canismes de redirection pour envoyer les utilisateurs vers des sites non fiables.",
                options: [
                    "Open Redirect (Unvalidated Redirect)",
                    "SSRF",
                    "Tabnabbing",
                    "Pharming"
                ],
                correct: 0,
                explanation: "L'**Open Redirect** (Unvalidated Redirect) permet de rediriger les utilisateurs vers des URLs arbitraires, souvent exploit√© dans le phishing (l'URL l√©gitime rassure avant la redirection malveillante). Protection: liste blanche de destinations, validation stricte des URLs, √©viter les redirections bas√©es sur param√®tres utilisateur, utiliser des identifiants au lieu d'URLs compl√®tes."
            },
            {
                id: 23,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle vuln√©rabilit√© OWASP Top 10 r√©sulte d'une mauvaise configuration des contr√¥les d'acc√®s permettant aux utilisateurs d'acc√©der √† des ressources ou fonctions non autoris√©es ?",
                hint: "Cette faille permet l'acc√®s √† des donn√©es ou fonctionnalit√©s en manipulant simplement les identifiants ou URLs.",
                options: [
                    "Injection",
                    "Broken Access Control",
                    "Security Misconfiguration",
                    "Cryptographic Failures"
                ],
                correct: 1,
                explanation: "**Broken Access Control** (Contr√¥le d'acc√®s d√©faillant) est #1 dans OWASP Top 10 2021. Permet: acc√®s non autoris√© √† des comptes (IDOR - Insecure Direct Object Reference), √©l√©vation de privil√®ges, modification de donn√©es. Exemples: changer l'ID utilisateur dans l'URL, acc√©der aux fonctions admin sans autorisation. Protection: contr√¥le d'acc√®s c√¥t√© serveur, deny by default, v√©rifier les permissions √† chaque requ√™te."
            },
            {
                id: 24,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un utilisateur modifie l'URL de 'profil.php?user_id=123' √† 'profil.php?user_id=124' et peut voir le profil d'un autre utilisateur. Quelle vuln√©rabilit√© de contr√¥le d'acc√®s est pr√©sente ?",
                hint: "Cette faille permet d'acc√©der aux donn√©es d'autres utilisateurs en manipulant simplement les identifiants dans les param√®tres.",
                options: [
                    "IDOR (Insecure Direct Object Reference)",
                    "Privilege Escalation",
                    "Session Fixation",
                    "Directory Traversal"
                ],
                correct: 0,
                explanation: "**IDOR (Insecure Direct Object Reference)** expose des r√©f√©rences directes √† des objets internes (IDs de base de donn√©es) sans v√©rification d'autorisation, permettant d'acc√©der aux donn√©es d'autres utilisateurs. Protection: v√©rification d'autorisation c√¥t√© serveur, utilisation d'identifiants indirects (GUIDs), mapping des IDs par session."
            },
            {
                id: 25,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle meilleure pratique de d√©veloppement s√©curis√© consiste √† rejeter toutes les entr√©es par d√©faut sauf celles explicitement autoris√©es (liste blanche) ?",
                hint: "Cette approche restrictive d√©finit ce qui est permis plut√¥t que ce qui est interdit.",
                options: [
                    "Input validation (Validation des entr√©es)",
                    "Output encoding (Encodage des sorties)",
                    "Error handling",
                    "Session management"
                ],
                correct: 0,
                explanation: "L'**Input validation** (validation des entr√©es) avec approche liste blanche (whitelist) accepte uniquement les entr√©es conformes √† un format attendu. Plus s√ªr que la liste noire (blacklist) qui tente de bloquer les mauvaises entr√©es. Principes: valider le type, longueur, format, plage de valeurs; rejeter les donn√©es suspectes; valider c√¥t√© serveur. Protection contre: injections, XSS, buffer overflows."
            },

            // Malwares (15 questions)
            {
                id: 26,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un ransomware a chiffr√© tous les fichiers d'une organisation et exige un paiement en Bitcoin pour la cl√© de d√©chiffrement. Quelle est la MEILLEURE d√©fense pr√©ventive contre ce type d'attaque ?",
                hint: "La r√©silience face au chiffrement malveillant n√©cessite une strat√©gie de r√©cup√©ration des donn√©es ind√©pendante.",
                options: [
                    "Antivirus √† jour avec d√©tection heuristique",
                    "Pare-feu de nouvelle g√©n√©ration (NGFW)",
                    "Sauvegardes offline r√©guli√®res (air-gapped)",
                    "Formation continue √† la s√©curit√© des utilisateurs"
                ],
                correct: 2,
                explanation: "Les **sauvegardes offline r√©guli√®res** (air-gapped, d√©connect√©es du r√©seau) permettent de restaurer les donn√©es sans payer la ran√ßon. R√®gle 3-2-1: 3 copies, 2 supports diff√©rents, 1 hors site. Tester r√©guli√®rement la restauration. L'antivirus, le pare-feu et la formation sont importants mais ne garantissent pas la r√©cup√©ration apr√®s chiffrement. Jamais payer la ran√ßon (pas de garantie de d√©chiffrement, finance le crime)."
            },
            {
                id: 27,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quel type de malware se propage automatiquement d'un syst√®me √† l'autre sans intervention humaine en exploitant des vuln√©rabilit√©s r√©seau comme EternalBlue ?",
                hint: "Ce logiciel malveillant est autonome et se r√©plique comme un organisme biologique.",
                options: [
                    "Virus",
                    "Cheval de Troie (Trojan)",
                    "Ver (Worm)",
                    "Rootkit"
                ],
                correct: 2,
                explanation: "Un **ver (worm)** est un malware autonome qui se r√©plique automatiquement via le r√©seau sans n√©cessiter de fichier h√¥te ni interaction utilisateur. Exemples c√©l√®bres: WannaCry (2017, EternalBlue/SMB), Conficker, Code Red, SQL Slammer. Un **virus** n√©cessite un programme h√¥te. Un **cheval de Troie** se d√©guise en logiciel l√©gitime. Un **rootkit** cache sa pr√©sence au niveau syst√®me."
            },
            {
                id: 28,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un administrateur d√©couvre qu'un logiciel malveillant s'est install√© au niveau du BIOS/UEFI et persiste m√™me apr√®s le reformatage du disque dur. Quel type de malware est pr√©sent ?",
                hint: "Ce type de malware infecte le firmware du syst√®me, avant le chargement du syst√®me d'exploitation.",
                options: [
                    "Bootkit",
                    "Rootkit kernel-mode",
                    "Ransomware",
                    "Fileless malware"
                ],
                correct: 0,
                explanation: "Un **bootkit** infecte le secteur de d√©marrage (MBR) ou le firmware (BIOS/UEFI) et se charge avant le syst√®me d'exploitation, offrant contr√¥le total, furtivit√© maximale et persistance apr√®s reformatage. Exemples: TDL4, Rovnix, LoJax (UEFI). Protection: Secure Boot, TPM, v√©rification d'int√©grit√© du firmware, mises √† jour BIOS/UEFI. Un **rootkit** op√®re au niveau syst√®me ou noyau. Le **fileless malware** r√©side en m√©moire."
            },
            {
                id: 29,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle technique de malware utilise des serveurs de commande et contr√¥le (C2) pour orchestrer des attaques DDoS distribu√©es √† partir de milliers de machines compromises ?",
                hint: "Ce r√©seau de machines infect√©es est contr√¥l√© √† distance comme une arm√©e de robots.",
                options: [
                    "Botnet",
                    "APT (Advanced Persistent Threat)",
                    "Rootkit",
                    "Logic Bomb"
                ],
                correct: 0,
                explanation: "Un **botnet** est un r√©seau de machines compromises (zombies/bots) contr√¥l√©es √† distance via des serveurs C2 pour effectuer des attaques DDoS, spam, cryptominage, credential stuffing. Exemples: Mirai (IoT), Zeus, Emotet. Communication: IRC, HTTP, P2P, DNS. Une **APT** est une campagne sophistiqu√©e et persistante. Un **rootkit** cache des malwares. Une **logic bomb** s'active selon des conditions."
            },
            {
                id: 30,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un malware se cache en modifiant le noyau du syst√®me d'exploitation pour intercepter les appels syst√®me et masquer sa pr√©sence aux outils de s√©curit√©. Quel type de malware est-ce ?",
                hint: "Ce malware op√®re au niveau le plus privil√©gi√© du syst√®me pour rester invisible.",
                options: [
                    "Virus",
                    "Rootkit (mode noyau)",
                    "Spyware",
                    "Adware"
                ],
                correct: 1,
                explanation: "Un **rootkit** (particuli√®rement en mode noyau) se cache en modifiant le syst√®me d'exploitation pour intercepter les appels syst√®me et masquer: processus, fichiers, cl√©s de registre, connexions r√©seau. Types: user-mode (moins invasif), kernel-mode (plus furtif), bootkit (firmware). D√©tection: scanners de rootkits (rkhunter, chkrootkit), analyse de m√©moire, comparaison avec une image propre. Le **spyware** espionne. L'**adware** affiche des publicit√©s."
            },
            {
                id: 31,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "SC√âNARIO: Un employ√© t√©l√©charge un logiciel gratuit de compression de fichiers depuis un site tiers. Le logiciel fonctionne normalement mais ouvre secr√®tement une backdoor permettant un acc√®s distant. Quel type de malware a √©t√© install√© ?",
                hint: "Ce malware se d√©guise en logiciel l√©gitime et utile.",
                options: [
                    "Virus",
                    "Ver (Worm)",
                    "Cheval de Troie (Trojan)",
                    "Ransomware"
                ],
                correct: 2,
                explanation: "Un **Cheval de Troie** (Trojan) se d√©guise en logiciel l√©gitime et utile mais contient des fonctionnalit√©s malveillantes cach√©es: backdoors, keyloggers, t√©l√©chargement de malwares suppl√©mentaires. Ne se r√©plique pas comme un virus. Exemples: Emotet, TrickBot, Zeus. Protection: t√©l√©charger uniquement depuis sources officielles, v√©rifier les signatures num√©riques, antivirus, principe du moindre privil√®ge."
            },
            {
                id: 32,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un malware enregistre secr√®tement toutes les frappes clavier de la victime, incluant mots de passe, num√©ros de cartes bancaires et messages priv√©s. Quel type de malware est utilis√© ?",
                hint: "Ce malware capture sp√©cifiquement les entr√©es au clavier.",
                options: [
                    "Keylogger",
                    "Screen scraper",
                    "RAT (Remote Access Trojan)",
                    "Rootkit"
                ],
                correct: 0,
                explanation: "Un **keylogger** enregistre les frappes clavier pour capturer mots de passe, informations bancaires, messages. Types: logiciel (hooks clavier) ou mat√©riel (entre clavier et PC). Protection: clavier virtuel pour infos sensibles, antivirus, d√©tection comportementale, chiffrement des communications. Le **screen scraper** capture l'√©cran. Le **RAT** offre un acc√®s distant complet. Le **rootkit** cache sa pr√©sence."
            },
            {
                id: 33,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un administrateur remarque une utilisation CPU de 100% et un trafic r√©seau sortant anormal sur plusieurs serveurs. L'analyse r√©v√®le un processus inconnu g√©n√©rant de la crypto-monnaie. Quel type de malware est pr√©sent ?",
                hint: "Ce malware d√©tourne les ressources informatiques pour miner de la monnaie virtuelle.",
                options: [
                    "Ransomware",
                    "Cryptojacking (Cryptominer)",
                    "Rootkit",
                    "Botnet"
                ],
                correct: 1,
                explanation: "Le **cryptojacking** (ou cryptominer) utilise les ressources CPU/GPU pour miner de la crypto-monnaie (Bitcoin, Monero, Ethereum) sans consentement. Sympt√¥mes: ralentissements, surchauffe, consommation √©lectrique √©lev√©e, ventilateurs bruyants. Peut √™tre: malware install√©, script web (Coinhive), exploit de vuln√©rabilit√©. D√©tection: surveillance CPU, analyse r√©seau (pools de minage), EDR."
            },
            {
                id: 34,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle technique de malware avanc√©e utilise uniquement la m√©moire RAM sans √©crire sur le disque dur, rendant la d√©tection par antivirus traditionnels tr√®s difficile ?",
                hint: "Ce malware r√©side uniquement en m√©moire volatile et dispara√Æt au red√©marrage.",
                options: [
                    "Fileless malware (Malware sans fichier)",
                    "Polymorphic malware",
                    "Encrypted malware",
                    "Macro malware"
                ],
                correct: 0,
                explanation: "Le **fileless malware** r√©side uniquement en m√©moire (RAM) et utilise des outils l√©gitimes du syst√®me (PowerShell, WMI, PsExec) pour ex√©cuter du code malveillant sans cr√©er de fichiers sur disque. Avantages: √©vite la d√©tection par antivirus bas√©s sur signatures, ne laisse pas de traces sur disque. D√©tection: EDR, analyse comportementale, surveillance de PowerShell, logging Windows Event. Exemples: techniques Living Off The Land (LOLBins)."
            },
            {
                id: 35,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un malware change constamment sa signature en modifiant son code √† chaque infection tout en conservant ses fonctionnalit√©s. Quelle technique d'√©vasion est utilis√©e ?",
                hint: "Ce malware se transforme pour √©viter la d√©tection par signatures.",
                options: [
                    "Polymorphic malware",
                    "Metamorphic malware",
                    "Encrypted malware",
                    "Armored malware"
                ],
                correct: 0,
                explanation: "Le **polymorphic malware** change sa signature √† chaque infection en chiffrant son code avec des cl√©s diff√©rentes ou en modifiant des instructions non essentielles, tout en conservant ses fonctionnalit√©s. Le **metamorphic malware** va plus loin en r√©√©crivant compl√®tement son code. L'**encrypted malware** chiffre son payload. L'**armored malware** utilise des techniques anti-analyse (anti-debugging, obfuscation). D√©tection: analyse heuristique et comportementale."
            },
            {
                id: 36,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un malware d√©tecte qu'il s'ex√©cute dans une machine virtuelle ou un sandbox et modifie son comportement pour para√Ætre inoffensif. Quelle technique d'√©vasion est utilis√©e ?",
                hint: "Ce malware d√©tecte les environnements d'analyse et se comporte diff√©remment.",
                options: [
                    "Code obfuscation",
                    "VM/Sandbox evasion",
                    "Rootkit techniques",
                    "Polymorphism"
                ],
                correct: 1,
                explanation: "La **VM/Sandbox evasion** d√©tecte les environnements d'analyse (VMware, VirtualBox, Cuckoo, Windows Defender Sandbox) via: d√©tection de VM (fichiers VMware Tools, processus VBox), d√©tection de sandbox (d√©lais d'ex√©cution, interactions utilisateur, ressources syst√®me limit√©es), puis modifie son comportement. Contre-mesure: environnements d'analyse bare-metal, techniques d'anti-√©vasion, analyse manuelle."
            },
            {
                id: 37,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "SC√âNARIO: Un employ√© malveillant ins√©rant discr√®tement du code dans une application qui se d√©clenchera automatiquement le jour de son d√©part pour supprimer toutes les bases de donn√©es. Quel type de malware a-t-il cr√©√© ?",
                hint: "Ce code malveillant s'active selon des conditions sp√©cifiques pr√©d√©finies.",
                options: [
                    "Virus",
                    "Logic Bomb (Bombe logique)",
                    "Backdoor",
                    "Trojan"
                ],
                correct: 1,
                explanation: "Une **logic bomb** (bombe logique) est du code malveillant qui reste dormant jusqu'√† ce qu'une condition sp√©cifique soit remplie: date/heure, action utilisateur, √©v√©nement syst√®me, absence de l'attaquant. Souvent utilis√©e par des insiders malveillants pour la vengeance ou l'extorsion. Protection: revues de code, monitoring des changements, principe du moindre privil√®ge, s√©paration des t√¢ches, analyse forensique des logs."
            },
            {
                id: 38,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle technique permet √† un malware de survivre apr√®s le red√©marrage du syst√®me en se r√©installant automatiquement ?",
                hint: "Cette capacit√© assure que le malware reste actif m√™me apr√®s les tentatives de suppression.",
                options: [
                    "Persistence mechanism",
                    "Polymorphism",
                    "Encryption",
                    "Obfuscation"
                ],
                correct: 0,
                explanation: "Les **persistence mechanisms** (m√©canismes de persistance) assurent que le malware survit au red√©marrage. Techniques Windows: cl√©s de registre Run/RunOnce, t√¢ches planifi√©es, services Windows, DLL hijacking, modification du d√©marrage. Techniques Linux: cron jobs, .bashrc, services systemd, modules noyau. Protection: surveillance des cl√©s de registre critiques, analyse des t√¢ches planifi√©es, EDR, Autoruns (Sysinternals)."
            },
            {
                id: 39,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un malware communique avec son serveur C2 en encodant les donn√©es dans des requ√™tes DNS pour exfiltrer des informations tout en √©vitant la d√©tection. Quelle technique de communication est utilis√©e ?",
                hint: "Cette technique abuse d'un protocole l√©gitime rarement bloqu√© pour transmettre des donn√©es.",
                options: [
                    "HTTPS tunneling",
                    "DNS tunneling",
                    "ICMP tunneling",
                    "Steganography"
                ],
                correct: 1,
                explanation: "Le **DNS tunneling** encode des donn√©es dans des requ√™tes et r√©ponses DNS pour exfiltrer des informations ou √©tablir un canal C2, car DNS est rarement bloqu√© et souvent non inspect√©. Les donn√©es sont encod√©es dans les sous-domaines ou les r√©ponses TXT. D√©tection: analyse des requ√™tes DNS anormalement longues, fr√©quence √©lev√©e, domaines suspects, entropy analysis. Protection: DNS filtering, monitoring DNS, limiter les r√©solveurs autoris√©s."
            },
            {
                id: 40,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle solution de s√©curit√© avanc√©e surveille le comportement des processus en temps r√©el sur les endpoints pour d√©tecter et bloquer les malwares bas√©s sur leurs actions plut√¥t que sur des signatures ?",
                hint: "Cette solution moderne remplace les antivirus traditionnels par une approche comportementale.",
                options: [
                    "Signature-based antivirus",
                    "EDR (Endpoint Detection and Response)",
                    "HIDS (Host-based IDS)",
                    "Personal firewall"
                ],
                correct: 1,
                explanation: "**EDR** (Endpoint Detection and Response) surveille continuellement les endpoints et enregistre les activit√©s pour d√©tecter les menaces via: analyse comportementale, machine learning, IoC, corr√©lation d'√©v√©nements. Capacit√©s: d√©tection, investigation forensique, containment, remediation. Exemples: CrowdStrike Falcon, SentinelOne, Microsoft Defender for Endpoint. L'**antivirus signature-based** d√©tecte les signatures connues. Le **HIDS** d√©tecte les intrusions. Le **personal firewall** filtre le r√©seau."
            },

            // Attaques r√©seau et protocoles (20 questions)
            {
                id: 41,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant envoie massivement des paquets SYN sans compl√©ter le three-way handshake TCP, saturant ainsi la table de connexions du serveur et emp√™chant les connexions l√©gitimes. Quelle attaque est utilis√©e ?",
                hint: "Cette attaque par d√©ni de service exploite le protocole de connexion TCP en laissant les connexions semi-ouvertes.",
                options: [
                    "Smurf attack",
                    "SYN flood",
                    "Ping of death",
                    "DNS amplification"
                ],
                correct: 1,
                explanation: "Le **SYN flood** envoie massivement des paquets SYN sans r√©pondre au SYN-ACK, cr√©ant des connexions semi-ouvertes qui √©puisent les ressources du serveur (backlog queue pleine). Protection: SYN cookies (g√©n√®rent des ISN cryptographiques sans allouer de ressources), augmentation de la backlog queue, rate limiting, filtrage des IPs sources, firewall stateful. La **Smurf attack** utilise ICMP broadcast. Le **Ping of death** envoie des paquets ICMP surdimensionn√©s. La **DNS amplification** abuse des serveurs DNS."
            },
            {
                id: 42,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant utilise Wireshark pour capturer le trafic r√©seau non chiffr√© sur un r√©seau WiFi public et extraire les identifiants de connexion transmis en clair. Quel type d'attaque passive est utilis√© ?",
                hint: "Cette technique d'√©coute passive analyse les paquets r√©seau sans les modifier.",
                options: [
                    "Sniffing (Reniflage de paquets)",
                    "Spoofing (Usurpation)",
                    "Session hijacking",
                    "ARP poisoning"
                ],
                correct: 0,
                explanation: "Le **sniffing** (reniflage de paquets) capture passivement le trafic r√©seau pour analyser les donn√©es en transit. Particuli√®rement efficace sur: r√©seaux WiFi non chiffr√©s, hubs (vs switches), protocoles non chiffr√©s (HTTP, FTP, Telnet, SMTP). Outils: Wireshark, tcpdump, Ettercap. Protection: chiffrement (HTTPS, SSH, VPN), switches avec port security, 802.1X. Le **spoofing** falsifie l'identit√©. Le **session hijacking** d√©tourne une session. L'**ARP poisoning** manipule les tables ARP."
            },
            {
                id: 43,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant envoie des r√©ponses ARP falsifi√©es sur le r√©seau local pour associer son adresse MAC √† l'adresse IP de la passerelle, s'intercalant ainsi entre deux machines pour intercepter leur communication. Quelle attaque est r√©alis√©e ?",
                hint: "Cette attaque manipule le protocole qui associe les adresses IP aux adresses MAC.",
                options: [
                    "DNS spoofing",
                    "ARP poisoning (ARP spoofing)",
                    "MAC flooding",
                    "VLAN hopping"
                ],
                correct: 1,
                explanation: "L'**ARP poisoning** (empoisonnement ARP / ARP spoofing) envoie de fausses r√©ponses ARP pour associer l'adresse MAC de l'attaquant √† l'adresse IP de la passerelle ou d'une autre machine, permettant une attaque Man-in-the-Middle. Protection: Static ARP entries (non scalable), Dynamic ARP Inspection (DAI) sur switches, port security, ARPWatch, segmentation r√©seau. Le **DNS spoofing** falsifie les r√©ponses DNS. Le **MAC flooding** sature la table CAM du switch. Le **VLAN hopping** saute entre VLANs."
            },
            {
                id: 44,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle attaque par d√©ni de service distribu√© (DDoS) utilise des serveurs DNS r√©cursifs ouverts pour amplifier le trafic malveillant vers la victime avec un facteur d'amplification pouvant atteindre 100:1 ?",
                hint: "Cette attaque exploite les r√©ponses volumineuses des serveurs DNS pour submerger la cible.",
                options: [
                    "SYN flood",
                    "DNS amplification",
                    "NTP amplification",
                    "HTTP flood"
                ],
                correct: 1,
                explanation: "L'**attaque par amplification DNS** exploite les serveurs DNS r√©cursifs mal configur√©s (open resolvers) en envoyant de petites requ√™tes (60 bytes) avec une adresse IP source usurp√©e (spoofing), g√©n√©rant de grandes r√©ponses (4000+ bytes) vers la victime. Requ√™te ANY sur un domaine avec de nombreux enregistrements = amplification maximale. Protection: d√©sactiver la r√©cursivit√© pour les IPs non autoris√©es, Response Rate Limiting (RRL), BCP 38 (anti-spoofing). L'**amplification NTP** utilise le protocole NTP (facteur 500:1). Le **SYN flood** exploite TCP. L'**HTTP flood** sature les serveurs web."
            },
            {
                id: 45,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un pentester utilise un outil pour scanner les ports ouverts d'un syst√®me distant et identifier les services en √©coute ainsi que leurs versions. Quelle commande Linux est la PLUS appropri√©e ?",
                hint: "Cet outil open-source est le scanner de ports le plus populaire utilis√© par les professionnels de la s√©curit√©.",
                options: [
                    "netstat",
                    "nmap",
                    "traceroute",
                    "ping"
                ],
                correct: 1,
                explanation: "**Nmap** (Network Mapper) est l'outil de r√©f√©rence pour: scan de ports (TCP/UDP), d√©tection de services et versions (-sV), d√©tection d'OS (-O), scripts NSE (Nmap Scripting Engine), d√©couverte de hosts. Commandes courantes: 'nmap -sS <IP>' (SYN scan), 'nmap -sV -sC <IP>' (version detection + scripts), 'nmap -A <IP>' (aggressive scan). **Netstat** affiche les connexions locales. **Traceroute** trace la route des paquets. **Ping** teste la connectivit√© ICMP."
            },
            {
                id: 46,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant intercepte et modifie la communication entre deux parties en temps r√©el sans que celles-ci s'en rendent compte. Quel type d'attaque active est r√©alis√© ?",
                hint: "L'attaquant se positionne au milieu de la communication pour √©couter et modifier les donn√©es.",
                options: [
                    "Sniffing passif",
                    "Man-in-the-Middle (MitM)",
                    "Replay attack",
                    "Denial of Service"
                ],
                correct: 1,
                explanation: "L'attaque **Man-in-the-Middle (MitM)** (homme du milieu) intercepte, relaie et potentiellement modifie la communication entre deux parties qui croient communiquer directement. Techniques: ARP poisoning, DNS spoofing, rogue WiFi, SSL stripping. Protection: chiffrement fort (TLS avec certificate pinning), VPN, authentification mutuelle, d√©tection d'anomalies r√©seau. Le **sniffing** est passif. La **replay attack** rejoue des donn√©es captur√©es. Le **DoS** rend indisponible."
            },
            {
                id: 47,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant capture une authentification r√©ussie et la rejoue plus tard pour obtenir un acc√®s non autoris√©. Quelle attaque exploite l'absence de protection contre la rediffusion ?",
                hint: "Cette attaque r√©utilise des donn√©es d'authentification intercept√©es pr√©c√©demment.",
                options: [
                    "Session hijacking",
                    "Replay attack",
                    "Man-in-the-Middle",
                    "Pass-the-hash"
                ],
                correct: 1,
                explanation: "Une **replay attack** (attaque par rejeu) capture et rejoue des donn√©es d'authentification valides intercept√©es pr√©c√©demment. Protection: timestamps (fen√™tre temporelle limit√©e), nonces (nombres al√©atoires √† usage unique), sequence numbers, challenge-response, tokens √† usage unique, Kerberos tickets avec timestamps. Le **session hijacking** vole une session active. Le **MitM** intercepte en temps r√©el. Le **pass-the-hash** r√©utilise des hash NTLM."
            },
            {
                id: 48,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant envoie un paquet ICMP Echo Request fragment√© dont la taille totale d√©passe 65 535 bytes, causant le crash de syst√®mes vuln√©rables. Quelle attaque historique est utilis√©e ?",
                hint: "Cette attaque ancienne mais c√©l√®bre utilise un paquet ICMP malform√© et surdimensionn√©.",
                options: [
                    "Ping flood",
                    "Smurf attack",
                    "Ping of Death",
                    "Fraggle attack"
                ],
                correct: 2,
                explanation: "Le **Ping of Death** envoie un paquet ICMP Echo Request malform√© d√©passant la taille maximale IP (65 535 bytes) via fragmentation, causant buffer overflow et crash des syst√®mes vuln√©rables. Attaque historique (ann√©es 90) mais les syst√®mes modernes sont g√©n√©ralement prot√©g√©s. Le **ping flood** envoie massivement des pings. La **Smurf attack** utilise ICMP broadcast avec IP spoofing. La **Fraggle attack** est similaire mais utilise UDP."
            },
            {
                id: 49,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Une attaque DDoS sature la bande passante r√©seau de la victime en envoyant un volume massif de trafic depuis de nombreuses sources. Quelle cat√©gorie d'attaque DDoS est utilis√©e ?",
                hint: "Cette attaque vise √† consommer toute la bande passante disponible plut√¥t que les ressources serveur.",
                options: [
                    "Volumetric attack",
                    "Protocol attack",
                    "Application layer attack",
                    "Zero-day exploit"
                ],
                correct: 0,
                explanation: "Les **volumetric attacks** (attaques volum√©triques) saturent la bande passante avec un volume massif de trafic (Gbps/Tbps): UDP floods, ICMP floods, amplification attacks (DNS, NTP, Memcached). Mesure: bits par seconde. Les **protocol attacks** (SYN flood, Ping of Death) √©puisent les ressources r√©seau/serveur. Les **application layer attacks** (HTTP flood, Slowloris) ciblent la couche 7. Mitigation: scrubbing centers, CDN (Cloudflare, Akamai), blackhole routing."
            },
            {
                id: 50,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Une attaque DDoS de couche 7 cible une application web en envoyant des requ√™tes HTTP apparemment l√©gitimes mais qui consomment beaucoup de ressources serveur (recherches complexes, t√©l√©chargements volumineux). Quelle attaque est utilis√©e ?",
                hint: "Cette attaque application semble l√©gitime et est difficile √† distinguer du trafic normal.",
                options: [
                    "SYN flood",
                    "HTTP flood",
                    "UDP flood",
                    "ICMP flood"
                ],
                correct: 1,
                explanation: "L'**HTTP flood** (ou application layer DDoS) envoie des requ√™tes HTTP apparemment l√©gitimes qui consomment les ressources serveur: GET floods (pages multiples), POST floods (formulaires), requ√™tes vers pages dynamiques co√ªteuses. Difficile √† bloquer car le trafic semble l√©gitime. Protection: rate limiting par IP, CAPTCHA, Web Application Firewall (WAF), analyse comportementale, CDN avec anti-DDoS. Le **SYN flood** est couche 4. L'**UDP/ICMP flood** est couche 3."
            },
            {
                id: 51,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "SC√âNARIO: Un serveur web devient lent et finit par crasher. L'analyse r√©v√®le des milliers de connexions TCP ouvertes maintenues actives ind√©finiment avec un trafic minimal. Quelle attaque de d√©ni de service est utilis√©e ?",
                hint: "Cette attaque maintient les connexions ouvertes le plus longtemps possible en envoyant des donn√©es tr√®s lentement.",
                options: [
                    "SYN flood",
                    "Slowloris",
                    "HTTP flood",
                    "Ping flood"
                ],
                correct: 1,
                explanation: "**Slowloris** est une attaque DoS de couche application qui maintient de nombreuses connexions HTTP ouvertes vers le serveur cible en envoyant des headers HTTP partiels tr√®s lentement, √©puisant les connexions disponibles avec un trafic minimal. Efficace contre les serveurs avec nombre limit√© de threads (Apache). Protection: limitation du nombre de connexions par IP, timeouts agressifs, reverse proxy (nginx, HAProxy), mod_qos, CDN."
            },
            {
                id: 52,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant envoie massivement des paquets avec une adresse IP source falsifi√©e pointant vers la victime. Quelle technique permet cette usurpation d'adresse ?",
                hint: "Cette technique falsifie l'adresse source des paquets IP pour masquer l'origine ou amplifier les attaques.",
                options: [
                    "MAC spoofing",
                    "IP spoofing",
                    "DNS spoofing",
                    "Email spoofing"
                ],
                correct: 1,
                explanation: "L'**IP spoofing** falsifie l'adresse IP source des paquets pour: masquer l'identit√© de l'attaquant, contourner les ACLs bas√©es sur IP, effectuer des attaques par r√©flexion/amplification (DDoS). Possible car IP n'authentifie pas la source. Protection: BCP 38 (ingress/egress filtering), uRPF (Unicast Reverse Path Forwarding), authentification au niveau applicatif. Le **MAC spoofing** falsifie l'adresse MAC. Le **DNS spoofing** falsifie les r√©ponses DNS. L'**email spoofing** falsifie l'exp√©diteur d'email."
            },
            {
                id: 53,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant sature la table CAM d'un switch en envoyant des milliers de paquets avec des adresses MAC sources diff√©rentes, for√ßant le switch √† agir comme un hub et diffuser tout le trafic. Quelle attaque de switch est utilis√©e ?",
                hint: "Cette attaque d√©borde la m√©moire du switch qui associe les adresses MAC aux ports.",
                options: [
                    "ARP poisoning",
                    "MAC flooding",
                    "VLAN hopping",
                    "STP attack"
                ],
                correct: 1,
                explanation: "Le **MAC flooding** sature la table CAM (Content Addressable Memory) du switch en envoyant des paquets avec des adresses MAC sources al√©atoires (macof). Quand la table est pleine, le switch passe en mode fail-open et diffuse le trafic √† tous les ports comme un hub, permettant le sniffing. Protection: port security (limite le nombre de MAC par port), sticky MAC, storm control. L'**ARP poisoning** manipule les tables ARP. Le **VLAN hopping** saute entre VLANs. L'**STP attack** manipule Spanning Tree Protocol."
            },
            {
                id: 54,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant configure son port comme trunk (802.1Q) pour acc√©der √† plusieurs VLANs non autoris√©s. Quelle attaque de segmentation r√©seau est exploit√©e ?",
                hint: "Cette attaque permet de sauter entre des VLANs normalement isol√©s.",
                options: [
                    "MAC flooding",
                    "ARP poisoning",
                    "VLAN hopping (Double tagging)",
                    "DHCP starvation"
                ],
                correct: 2,
                explanation: "Le **VLAN hopping** permet d'acc√©der √† des VLANs non autoris√©s via: switch spoofing (n√©gocier un trunk avec DTP - Dynamic Trunking Protocol), double tagging (802.1Q avec deux tags VLAN). Protection: d√©sactiver DTP (switchport mode access / switchport nonegotiate), configurer le native VLAN inutilis√©, ne pas utiliser le VLAN 1, private VLANs. Le **MAC flooding** sature la table CAM. L'**ARP poisoning** manipule ARP. Le **DHCP starvation** √©puise le pool DHCP."
            },
            {
                id: 55,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant √©puise toutes les adresses IP disponibles dans le pool DHCP en envoyant des milliers de requ√™tes DHCP DISCOVER avec des adresses MAC diff√©rentes. Quelle attaque est r√©alis√©e ?",
                hint: "Cette attaque de d√©ni de service cible le service d'attribution d'adresses IP.",
                options: [
                    "DHCP starvation",
                    "DHCP spoofing (Rogue DHCP)",
                    "MAC flooding",
                    "ARP poisoning"
                ],
                correct: 0,
                explanation: "La **DHCP starvation** √©puise le pool DHCP en envoyant massivement des DHCP DISCOVER avec des MAC sources al√©atoires, emp√™chant les clients l√©gitimes d'obtenir une adresse IP (DoS). Souvent suivie d'une attaque Rogue DHCP. Protection: DHCP snooping (limite le nombre de requ√™tes par port, trust/untrust ports), port security, rate limiting. Le **DHCP spoofing** (Rogue DHCP) fournit de fausses configurations via un serveur DHCP malveillant."
            },
            {
                id: 56,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle attaque DNS remplace temporairement les entr√©es l√©gitimes dans le cache DNS d'un serveur r√©cursif par des adresses IP malveillantes, redirigeant ainsi le trafic vers des sites contr√¥l√©s par l'attaquant ?",
                hint: "Cette attaque empoisonne le cache du serveur DNS pour rediriger massivement les utilisateurs.",
                options: [
                    "DNS poisoning (Cache poisoning)",
                    "DNS tunneling",
                    "DNS amplification",
                    "Domain hijacking"
                ],
                correct: 0,
                explanation: "Le **DNS poisoning** (ou DNS cache poisoning) corrompt le cache DNS en y injectant de fausses entr√©es, redirigeant les utilisateurs vers des sites malveillants. L'attaque Kaminsky (2008) exploitait la pr√©visibilit√© des transaction IDs. Protection: DNSSEC (signatures cryptographiques), randomisation des ports sources et transaction IDs, limitation de la r√©cursivit√©. Le **DNS tunneling** exfiltre des donn√©es via DNS. La **DNS amplification** est une attaque DDoS. Le **domain hijacking** d√©tourne l'enregistrement du domaine."
            },
            {
                id: 57,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Quelle extension de s√©curit√© DNS utilise des signatures cryptographiques pour garantir l'authenticit√© et l'int√©grit√© des r√©ponses DNS, prot√©geant ainsi contre le cache poisoning ?",
                hint: "Ce standard ajoute une cha√Æne de confiance cryptographique au syst√®me DNS.",
                options: [
                    "DNS over HTTPS (DoH)",
                    "DNS over TLS (DoT)",
                    "DNSSEC",
                    "Split-horizon DNS"
                ],
                correct: 2,
                explanation: "**DNSSEC** (DNS Security Extensions) signe cryptographiquement les enregistrements DNS pour garantir leur authenticit√© et int√©grit√© via une cha√Æne de confiance depuis la zone racine. Utilise: RRSIG (signatures), DNSKEY (cl√©s publiques), DS (Delegation Signer). Limitations: ne chiffre pas les requ√™tes, overhead de taille, complexit√© de d√©ploiement. **DoH** et **DoT** chiffrent les requ√™tes DNS. Le **Split-horizon DNS** fournit des r√©ponses diff√©rentes selon l'origine."
            },
            {
                id: 58,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant compromet un site web l√©gitime fr√©quemment visit√© par les employ√©s d'une entreprise cible pour infecter sp√©cifiquement cette organisation. Quelle strat√©gie d'attaque cibl√©e est employ√©e ?",
                hint: "Cette technique infecte strat√©giquement un 'point d'eau' o√π les cibles viennent naturellement.",
                options: [
                    "Watering hole attack",
                    "Drive-by download",
                    "Spear phishing",
                    "Pharming"
                ],
                correct: 0,
                explanation: "Une **Watering hole attack** (attaque du point d'eau) compromet un site web l√©gitime fr√©quent√© par un groupe cible sp√©cifique (industrie, r√©gion, organisation) pour infecter les visiteurs avec des exploits zero-day. Inspir√©e du comportement animal (pr√©dateurs guettant pr√®s des points d'eau). C'est une strat√©gie APT sophistiqu√©e. Le **drive-by download** est la technique d'infection. Le **spear phishing** utilise l'email. Le **pharming** redirige via DNS."
            },
            {
                id: 59,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "Un attaquant exploite une vuln√©rabilit√© zero-day dans un navigateur web en envoyant aux victimes un lien vers un site web malveillant qui ex√©cute automatiquement du code sans aucune interaction utilisateur. Quelle technique d'attaque est utilis√©e ?",
                hint: "Cette attaque exploite le navigateur simplement en visitant une page web compromise, sans t√©l√©chargement intentionnel.",
                options: [
                    "Drive-by download",
                    "Clickjacking",
                    "Typosquatting",
                    "Social engineering"
                ],
                correct: 0,
                explanation: "Un **Drive-by download** exploite les vuln√©rabilit√©s du navigateur, de ses plugins (Flash, Java, PDF) ou du syst√®me d'exploitation pour installer automatiquement un malware lors de la simple visite d'un site web compromis, sans action ni consentement de l'utilisateur. Protection: navigateur et plugins √† jour, bloqueurs de scripts (NoScript, uBlock Origin), antivirus, d√©sactiver les plugins obsol√®tes. Le **clickjacking** cache des √©l√©ments cliquables. Le **typosquatting** utilise des domaines similaires."
            },
            {
                id: 60,
                domain: "Menaces et Vuln√©rabilit√©s",
                question: "SC√âNARIO: Une organisation de sant√© d√©couvre qu'un attaquant a maintenu un acc√®s persistant et furtif √† son r√©seau pendant 18 mois, exfiltrant progressivement des dossiers patients sensibles. Quel type de menace sophistiqu√©e cela repr√©sente-t-il ?",
                hint: "Cette menace est caract√©ris√©e par sa sophistication technique, sa persistance √† long terme et sa discr√©tion.",
                options: [
                    "Script kiddie",
                    "Hacktiviste",
                    "APT (Advanced Persistent Threat)",
                    "Insider threat occasionnel"
                ],
                correct: 2,
                explanation: "Une **APT** (Advanced Persistent Threat - Menace Persistante Avanc√©e) est une campagne d'attaque sophistiqu√©e et coordonn√©e, g√©n√©ralement parrain√©e par un √âtat-nation ou une organisation criminelle organis√©e, maintenant un acc√®s furtif √† long terme (mois/ann√©es) pour l'espionnage, le vol de propri√©t√© intellectuelle ou le sabotage. Caract√©ristiques: sophistication technique √©lev√©e, objectifs sp√©cifiques, ressources importantes, patience et persistance, techniques d'√©vasion avanc√©es. Exemples: APT28/29 (Russie), APT1 (Chine), Lazarus Group (Cor√©e du Nord). Les **script kiddies** utilisent des outils existants. Les **hacktivistes** ont des motivations id√©ologiques."
            },

            // Suite √† venir avec 190+ questions suppl√©mentaires...
            // Pour la d√©monstration, j'inclus un √©chantillon repr√©sentatif de chaque domaine
            // La version compl√®te contiendrait 250+ questions

            // DOMAINE 2: ARCHITECTURE ET CONCEPTION (50+ questions)
            {
                id: 61,
                domain: "Architecture et Conception",
                question: "Une entreprise souhaite isoler les serveurs de bases de donn√©es critiques du r√©seau g√©n√©ral pour limiter les mouvements lat√©raux en cas de compromission. Quelle technologie de segmentation r√©seau au niveau de la couche 2 est la PLUS appropri√©e ?",
                hint: "Cette technologie permet de cr√©er des segments r√©seau logiques sans n√©cessiter de mat√©riel suppl√©mentaire.",
                options: [
                    "VPN",
                    "VLAN",
                    "NAT",
                    "Proxy"
                ],
                correct: 1,
                explanation: "Les **VLAN** (Virtual LAN) permettent de segmenter logiquement le r√©seau au niveau de la couche 2 pour isoler le trafic selon des crit√®res d√©finis (d√©partements, fonctions, niveaux de s√©curit√©). Avantages: r√©duction des domaines de broadcast, isolation de s√©curit√©, flexibilit√© sans rec√¢blage. Configuration: ports access (un VLAN) ou trunk (multiples VLANs avec 802.1Q). Les **VPN** cr√©ent des tunnels chiffr√©s. Le **NAT** traduit les adresses IP. Un **proxy** interm√©die les requ√™tes."
            },
            {
                id: 62,
                domain: "Architecture et Conception",
                question: "Quel mod√®le de s√©curit√© r√©seau moderne suppose qu'aucune entit√© (interne ou externe) ne doit √™tre automatiquement approuv√©e et n√©cessite une v√©rification continue de tous les acc√®s ?",
                hint: "Ce mod√®le remet en question le concept traditionnel de p√©rim√®tre de s√©curit√© avec un r√©seau interne 'de confiance'.",
                options: [
                    "D√©fense en profondeur",
                    "Zero Trust",
                    "P√©rim√®tre de s√©curit√©",
                    "Moindre privil√®ge"
                ],
                correct: 1,
                explanation: "Le mod√®le **Zero Trust** (confiance z√©ro) repose sur le principe 'ne jamais faire confiance, toujours v√©rifier' (Never Trust, Always Verify). √âlimine la confiance implicite bas√©e sur l'emplacement r√©seau et v√©rifie continuellement chaque acc√®s. Principes: micro-segmentation, moindre privil√®ge, MFA, inspection et logging de tout le trafic, assumer une compromission (breach assumption). Impl√©mentation: Software-Defined Perimeter (SDP), Identity and Access Management (IAM), Network Access Control. La **d√©fense en profondeur** utilise plusieurs couches."
            },
            {
                id: 63,
                domain: "Architecture et Conception",
                question: "Une organisation h√©berge un serveur web public accessible depuis Internet tout en prot√©geant son r√©seau interne. Dans quelle zone r√©seau ce serveur devrait-il √™tre plac√© ?",
                hint: "Cette zone tampon se situe entre le r√©seau externe non fiable et le r√©seau interne de confiance.",
                options: [
                    "Intranet",
                    "DMZ (Zone d√©militaris√©e)",
                    "VLAN priv√©",
                    "Extranet"
                ],
                correct: 1,
                explanation: "La **DMZ** (Zone D√©militaris√©e ou r√©seau p√©rim√©trique) est un sous-r√©seau qui h√©berge les services publics (serveurs web, mail, DNS, FTP) tout en les isolant du r√©seau interne. Architecture typique: √† trois pattes avec deux pare-feu (externe: Internet ‚Üî DMZ, interne: DMZ ‚Üî LAN) ou √† une patte avec un pare-feu multi-zones. L'**Intranet** est le r√©seau interne priv√©. Un **VLAN priv√©** segmente le r√©seau interne. L'**Extranet** permet un acc√®s contr√¥l√© aux partenaires."
            },
            // ... (Plus de questions suivent pour atteindre 250+)

            // DOMAINE 3: MISE EN ≈íUVRE (60+ questions)
            {
                id: 100,
                domain: "Mise en ≈ìuvre",
                question: "Quelle m√©thode d'authentification multifacteur (MFA) utilise une application mobile g√©n√©rant des codes temporaires de 6 chiffres bas√©s sur le temps (TOTP) qui changent toutes les 30 secondes ?",
                hint: "Cette m√©thode ne n√©cessite pas de connexion r√©seau et utilise un algorithme synchronis√© avec le serveur.",
                options: [
                    "SMS OTP",
                    "Authentificateur logiciel (Google Authenticator, Microsoft Authenticator)",
                    "Token mat√©riel (YubiKey)",
                    "Notification push"
                ],
                correct: 1,
                explanation: "Les **authentificateurs logiciels** comme Google Authenticator ou Microsoft Authenticator g√©n√®rent des codes TOTP (Time-based One-Time Password - RFC 6238) bas√©s sur un secret partag√© lors de l'enregistrement et l'heure actuelle. Avantages: pas de connexion r√©seau requise, meilleur que SMS (r√©siste au SIM swapping). Alternative: HOTP (HMAC-based OTP - bas√© sur un compteur). Le **SMS OTP** est vuln√©rable au SIM swapping. Le **token mat√©riel** est un dispositif physique (plus s√©curis√©). La **notification push** envoie une demande d'approbation."
            },

            // DOMAINE 4: OP√âRATIONS ET R√âPONSE AUX INCIDENTS (40+ questions)
            {
                id: 150,
                domain: "Op√©rations et R√©ponse aux incidents",
                question: "Quelle est la PREMI√àRE √©tape du processus de r√©ponse √† incident selon le framework NIST SP 800-61 ?",
                hint: "Cette phase pr√©ventive et pr√©paratoire se d√©roule AVANT qu'un incident ne se produise.",
                options: [
                    "D√©tection et analyse",
                    "Pr√©paration",
                    "Containment (Confinement)",
                    "R√©cup√©ration"
                ],
                correct: 1,
                explanation: "Selon le **NIST SP 800-61**, les phases de r√©ponse √† incident sont: 1) **Pr√©paration** (cr√©ation de politiques, formation de l'√©quipe CSIRT/CERT, acquisition d'outils, √©tablissement de communications), 2) D√©tection et Analyse, 3) Confinement, √âradication et R√©cup√©ration, 4) Activit√©s post-incident (lessons learned). La **pr√©paration** est cruciale pour une r√©ponse efficace."
            },

            // DOMAINE 5: GOUVERNANCE, RISQUE ET CONFORMIT√â (35+ questions)
            {
                id: 200,
                domain: "Gouvernance, Risque et Conformit√©",
                question: "Quelle strat√©gie de gestion des risques consiste √† transf√©rer le risque √† une tierce partie, comme une compagnie d'assurance cyber ?",
                hint: "Cette approche ne supprime pas le risque mais en transf√®re la responsabilit√© financi√®re √† un tiers.",
                options: [
                    "Risk acceptance (Acceptation du risque)",
                    "Risk avoidance (√âvitement du risque)",
                    "Risk mitigation (Att√©nuation du risque)",
                    "Risk transference (Transfert du risque)"
                ],
                correct: 3,
                explanation: "Le **Risk transference** (transfert de risque) d√©place la responsabilit√© financi√®re vers un tiers: assurance cyber (couvre les pertes), contrats avec clauses de responsabilit√©, outsourcing avec SLA. L'**acceptance** assume consciemment le risque (acceptable pour risques faibles). L'**avoidance** √©limine l'activit√© √† risque. La **mitigation** r√©duit la probabilit√© ou l'impact par des contr√¥les de s√©curit√© (la plus commune)."
            },
            {
                id: 201,
                domain: "Gouvernance, Risque et Conformit√©",
                question: "Quelle r√©glementation europ√©enne prot√®ge les donn√©es personnelles des citoyens de l'UE et impose des amendes pouvant atteindre 4% du chiffre d'affaires mondial ou 20 millions d'euros ?",
                hint: "Ce r√®glement entr√© en vigueur en mai 2018 a transform√© la protection des donn√©es √† l'√©chelle mondiale.",
                options: [
                    "HIPAA",
                    "SOX",
                    "RGPD (GDPR)",
                    "PCI DSS"
                ],
                correct: 2,
                explanation: "Le **RGPD** (R√®glement G√©n√©ral sur la Protection des Donn√©es) ou GDPR prot√®ge les donn√©es personnelles des citoyens europ√©ens avec des principes: consentement explicite, minimisation des donn√©es, droit √† l'oubli, portabilit√©, notification de violation sous 72h, DPO obligatoire pour certaines organisations. Amendes: jusqu'√† 4% du CA mondial ou 20M‚Ç¨. S'applique √† toute organisation traitant des donn√©es de r√©sidents UE. **HIPAA** prot√®ge les donn√©es de sant√© US. **SOX** r√©gule les rapports financiers. **PCI DSS** s√©curise les cartes de paiement."
            },
            {
                id: 202,
                domain: "Gouvernance, Risque et Conformit√©",
                question: "Quelle norme internationale certifiable sp√©cifie les exigences pour √©tablir, impl√©menter et am√©liorer continuellement un syst√®me de management de la s√©curit√© de l'information (ISMS) ?",
                hint: "Cette norme fait partie de la famille ISO/IEC 2700x et est bas√©e sur le cycle PDCA.",
                options: [
                    "ISO 27001",
                    "NIST SP 800-53",
                    "CIS Controls",
                    "COBIT"
                ],
                correct: 0,
                explanation: "L'**ISO/IEC 27001** est la norme internationale certifiable pour les ISMS (Information Security Management System), bas√©e sur le cycle PDCA (Plan-Do-Check-Act) d'am√©lioration continue. Annexe A: 114 contr√¥les (r√©f√©rence ISO 27002). Certification par audit externe. Avantages: reconnaissance internationale, framework structur√©, am√©lioration continue. L'**ISO 27002** fournit les bonnes pratiques d√©taill√©es. Le **NIST SP 800-53** d√©taille les contr√¥les de s√©curit√© pour les agences f√©d√©rales US. Les **CIS Controls** sont 18 actions de s√©curit√© prioritaires. **COBIT** est un framework de gouvernance IT."
            },

            // Questions suppl√©mentaires pour enrichir la banque
            // Note: La version compl√®te contiendrait 250+ questions
            // Ceci est un √©chantillon repr√©sentatif de tous les domaines
        ];

        // Variables globales pour le quiz
        let currentQuiz = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let selectedAnswer = null;
        let domainStats = {};

        // Initialiser les statistiques par domaine
        function initializeDomainStats() {
            const domains = [...new Set(QUESTION_BANK.map(q => q.domain))];
            domainStats = {};
            domains.forEach(domain => {
                domainStats[domain] = { correct: 0, total: 0 };
            });
        }

        // D√©marrer un quiz avec le nombre de questions s√©lectionn√©
        function startQuiz(numQuestions) {
            // M√©langer et s√©lectionner les questions
            const shuffled = [...QUESTION_BANK].sort(() => Math.random() - 0.5);
            currentQuiz = shuffled.slice(0, Math.min(numQuestions, QUESTION_BANK.length));
            
            currentQuestionIndex = 0;
            score = 0;
            initializeDomainStats();
            
            // Afficher l'√©cran de quiz
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('quizScreen').style.display = 'block';
            
            // Charger la premi√®re question
            loadQuestion();
        }

        // Charger une question
        function loadQuestion() {
            const question = currentQuiz[currentQuestionIndex];
            selectedAnswer = null;
            
            // Mettre √† jour la barre de progression
            const progress = ((currentQuestionIndex + 1) / currentQuiz.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            // Cr√©er le HTML de la question
            const questionHTML = `
                <div class="question-card">
                    <div class="question-header">
                        <span class="question-number">Question ${currentQuestionIndex + 1}/${currentQuiz.length}</span>
                        <span class="domain-tag">${question.domain}</span>
                    </div>
                    <div class="question-text">${question.question}</div>
                    <div class="hint-box">
                        <button class="hint-toggle" onclick="toggleHint()">üí° Afficher l'indice</button>
                        <div class="hint-content" id="hintContent">${question.hint}</div>
                    </div>
                    <div class="options">
                        ${question.options.map((option, index) => `
                            <div class="option" onclick="selectAnswer(${index})" id="option-${index}">
                                <div class="option-letter">${String.fromCharCode(65 + index)}</div>
                                <div class="option-text">${option}</div>
                            </div>
                        `).join('')}
                    </div>
                    <div class="explanation" id="explanation">
                        <h4>‚úÖ Explication d√©taill√©e</h4>
                        <p>${question.explanation}</p>
                    </div>
                </div>
            `;
            
            document.getElementById('questionContainer').innerHTML = questionHTML;
            document.getElementById('submitBtn').style.display = 'block';
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('submitBtn').disabled = true;
        }

        // Basculer l'affichage de l'indice
        function toggleHint() {
            const hint = document.getElementById('hintContent');
            hint.style.display = hint.style.display === 'block' ? 'none' : 'block';
        }

        // S√©lectionner une r√©ponse
        function selectAnswer(index) {
            if (document.getElementById('submitBtn').style.display === 'none') return;
            
            selectedAnswer = index;
            const options = document.querySelectorAll('.option');
            options.forEach((opt, idx) => {
                opt.classList.remove('selected');
                if (idx === index) opt.classList.add('selected');
            });
            document.getElementById('submitBtn').disabled = false;
        }

        // Soumettre la r√©ponse
        function submitAnswer() {
            if (selectedAnswer === null) return;
            
            const question = currentQuiz[currentQuestionIndex];
            const options = document.querySelectorAll('.option');
            
            // Marquer la r√©ponse correcte et incorrecte
            options.forEach((opt, idx) => {
                if (idx === question.correct) {
                    opt.classList.add('correct');
                } else if (idx === selectedAnswer) {
                    opt.classList.add('incorrect');
                }
                opt.style.pointerEvents = 'none'; // D√©sactiver les clics
            });
            
            // Mettre √† jour le score et les statistiques
            domainStats[question.domain].total++;
            if (selectedAnswer === question.correct) {
                score++;
                domainStats[question.domain].correct++;
            }
            
            // Afficher l'explication
            document.getElementById('explanation').style.display = 'block';
            document.getElementById('submitBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'block';
        }

        // Question suivante
        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < currentQuiz.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        // Question pr√©c√©dente
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                // Note: Dans une version compl√®te, il faudrait sauvegarder les r√©ponses
                alert('Navigation vers les questions pr√©c√©dentes d√©sactiv√©e dans cette version. Utilisez le bouton Recommencer pour refaire le quiz.');
            }
        }

        // Afficher les r√©sultats
        function showResults() {
            const percentage = Math.round((score / currentQuiz.length) * 100);
            const passingScore = 75; // Score de passage similaire au vrai examen
            const passed = percentage >= passingScore;
            
            document.getElementById('quizScreen').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'block';
            
            // Afficher le score principal
            const scoreColor = passed ? '#10b981' : (percentage >= 60 ? '#f59e0b' : '#ef4444');
            document.getElementById('scoreDisplay').innerHTML = `
                <h2 style="font-size: 4em; margin-bottom: 20px;">${percentage}%</h2>
                <p style="font-size: 1.5em;">
                    ${passed ? 'üéâ F√âLICITATIONS! Vous avez r√©ussi!' : percentage >= 60 ? 'üìö Bon effort! Continuez √† vous entra√Æner!' : 'üí™ R√©visez et r√©essayez!'}
                </p>
                <p style="margin-top: 15px; font-size: 1.1em;">
                    ${score} / ${currentQuiz.length} r√©ponses correctes
                </p>
                <p style="margin-top: 10px; opacity: 0.9;">
                    ${passed ? 'Votre score d√©passe le seuil de passage de 75%. Excellent travail!' : 
                      percentage >= 60 ? 'Vous √™tes proche du seuil de passage (75%). R√©visez les domaines faibles.' :
                      'Le score de passage est de 75%. Concentrez-vous sur les domaines √† am√©liorer.'}
                </p>
            `;
            
            // Ajuster la couleur du score
            document.querySelector('.score-display').style.background = `linear-gradient(135deg, ${scoreColor} 0%, ${scoreColor}dd 100%)`;
            
            // Cr√©er les cartes de statistiques
            document.getElementById('statsGrid').innerHTML = `
                <div class="stat-card">
                    <h3>Questions</h3>
                    <p>${currentQuiz.length}</p>
                </div>
                <div class="stat-card">
                    <h3>Correctes</h3>
                    <p style="color: #10b981;">${score}</p>
                </div>
                <div class="stat-card">
                    <h3>Incorrectes</h3>
                    <p style="color: #ef4444;">${currentQuiz.length - score}</p>
                </div>
                <div class="stat-card">
                    <h3>Pr√©cision</h3>
                    <p style="color: ${scoreColor};">${percentage}%</p>
                </div>
            `;
            
            // Afficher les r√©sultats par domaine
            let domainHTML = '<h3 style="margin-bottom: 20px;">üìä Performance par domaine</h3>';
            Object.keys(domainStats).sort().forEach(domain => {
                const stats = domainStats[domain];
                if (stats.total > 0) {
                    const domainPercentage = Math.round((stats.correct / stats.total) * 100);
                    const domainColor = domainPercentage >= 75 ? '#10b981' : domainPercentage >= 60 ? '#f59e0b' : '#ef4444';
                    domainHTML += `
                        <div class="domain-result">
                            <div class="domain-result-header">
                                <strong>${domain}</strong>
                                <span style="color: ${domainColor};">${stats.correct}/${stats.total} (${domainPercentage}%)</span>
                            </div>
                            <div class="domain-bar">
                                <div class="domain-bar-fill" style="width: ${domainPercentage}%; background: ${domainColor};"></div>
                            </div>
                        </div>
                    `;
                }
            });
            document.getElementById('domainResults').innerHTML = domainHTML;
        }
    </script>
</body>
</html>